{
  "kind": "build_request",
  "title": "Port Q2 ANSWERS trivia quiz game into React app with leveling, persistence, share, and audio controls",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Implement the core trivia gameplay UI in the React frontend to match the provided HTML app: header (logo/title, level badge, share button, mute/play toggle), progress bar, quiz area (question + four multiple-choice answers), level-up celebration overlay (Continue + Share), and a bottom ad placeholder banner.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "This is my code for Q2 Answer gam app ..."
        ]
      },
      "acceptanceCriteria": [
        "The app renders a single-page mobile-friendly game container with a header, progress bar, quiz area, and ad placeholder banner.",
        "Answer options are rendered as clickable buttons; after selection, buttons are locked until the next question is loaded.",
        "Correct selection highlights the selected answer as correct; incorrect selection highlights the selected answer as wrong and also highlights the correct answer as correct.",
        "A level-up overlay is displayed when the player reaches the level goal, with Continue and Share actions.",
        "All user-facing text is in English (do not include emoji characters in labels/messages)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Integrate OpenTDB question fetching in the frontend using the same endpoints and logic as the provided code: request a session token from https://opentdb.com/api_token.php?command=request and fetch one multiple-choice question at a time from https://opentdb.com/api.php?amount=1&type=multiple&token=TOKEN, including handling OpenTDB response codes 3/4 by renewing the token and retrying.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "const res = await fetch('https://opentdb.com/api_token.php?command=request');",
          "let url = `https://opentdb.com/api.php?amount=1&type=multiple&token=${state.sessionToken}`;",
          "} else if (data.response_code === 3 || data.response_code === 4) { await getSessionToken(); loadQuestion(); }"
        ]
      },
      "acceptanceCriteria": [
        "On initial load, the app requests an OpenTDB session token and stores it in memory for subsequent question requests.",
        "The app fetches and displays one multiple-choice question at a time from OpenTDB.",
        "If OpenTDB returns response_code 3 or 4, the app requests a new token and retries fetching a question automatically.",
        "If a fetch fails or OpenTDB returns a non-0 non-3/4 response code, the app retries after a short delay without crashing the UI.",
        "Question text and answer text are HTML-decoded before display."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Implement leveling/progression rules exactly as provided: maintain state fields (level, correctCount) where the per-level goal is computed as goal = 5 + (level * 2); increment correctCount on correct answers; when correctCount >= goal, increment level and reset correctCount to 0 and show the level-up overlay.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "let goal = 5 + (state.level * 2);",
          "if (state.correctCount >= goal) { state.level++; state.correctCount = 0; ... setTimeout(showCelebration, 800); return; }"
        ]
      },
      "acceptanceCriteria": [
        "The progress bar fill percentage is computed as (correctCount / goal) * 100 and clamped to 0â€“100.",
        "Level badge shows the current level as \"LV {level}\".",
        "After a correct answer that completes the goal, the level-up overlay appears and the next question does not load until Continue is clicked.",
        "Clicking Continue closes the overlay and loads the next question.",
        "Progress is updated after each question resolution and after leveling up."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Persist player progress (level and correctCount) in browser localStorage using the same storage key q2_official_save; on app load, restore saved progress if present.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "localStorage.getItem('q2_official_save')",
          "localStorage.setItem('q2_official_save', JSON.stringify({ level: state.level, correctCount: state.correctCount }))"
        ]
      },
      "acceptanceCriteria": [
        "Refreshing the page restores the last saved level and correctCount values.",
        "The localStorage key name is exactly \"q2_official_save\".",
        "Progress is saved after each answered question and after leveling up."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Add share-score functionality in the frontend with Web Share API and clipboard fallback, based on the provided logic, but ensure the shared/copied message is English-only (no emoji characters).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "if (navigator.share) { await navigator.share({ title: 'Q2 ANSWERS', text: shareText, url: window.location.href }); } else { navigator.clipboard.writeText(shareText); alert(\"Score copied to clipboard! Paste it to your friends. ðŸš€\"); }"
        ]
      },
      "acceptanceCriteria": [
        "Share controls are available from both the header and the level-up overlay.",
        "If navigator.share is available, invoking Share opens the native share dialog with title \"Q2 ANSWERS\", a text message containing the current level, and the current page URL.",
        "If navigator.share is unavailable, clicking Share copies the share text to the clipboard and displays an English-only confirmation message (no emojis)."
      ]
    },
    {
      "id": "REQ-6",
      "text": "Add background music playback with a mute/play toggle using the provided audio source URL (https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3) and initialize the app with audio muted until the user enables playback.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "<audio id=\"bg-music\" loop><source src=\"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3\" type=\"audio/mpeg\"></audio>",
          "let state = { ... isMuted: true ... }",
          "function toggleMute() { ... if (state.isMuted) audio.pause(); else audio.play() ... }"
        ]
      },
      "acceptanceCriteria": [
        "The app loads with music muted/off by default.",
        "Toggling the control starts playback (handling autoplay restrictions by only attempting play after user interaction) and toggling again pauses playback.",
        "The toggle control label is English-only (no emoji characters).",
        "Music loops during gameplay when enabled."
      ]
    },
    {
      "id": "REQ-7",
      "text": "Apply a coherent visual theme across the frontend inspired by the provided design (emerald/green primary, warm light background, card-like mobile container), implemented with Tailwind styling and shadcn UI composition where appropriate, without using a blue/purple primary theme.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          ":root { --primary: #075e54; --bg: #ece5dd; --white: #fff; --blue: #34b7f1; --red: #ff3b30; --green: #25d366; --gold: #ffc107; }"
        ]
      },
      "acceptanceCriteria": [
        "UI uses a consistent palette with an emerald/green primary and warm neutral background, and avoids a blue/purple primary theme.",
        "The main game container is centered with a max width suitable for mobile (similar to ~500px) and has a subtle shadow and rounded corners.",
        "Correct/wrong states are visually distinct and accessible (contrast sufficient to read text).",
        "The level-up overlay visually stands out and covers the game container content when visible."
      ]
    },
    {
      "id": "REQ-8",
      "text": "Generate and include a simple static app logo image asset and render it in the header in place of (or alongside) the text-only \"Q2\" logo block.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "<div class=\"app-logo\">Q2</div>"
        ]
      },
      "acceptanceCriteria": [
        "A generated logo image is added under frontend/public/assets/generated and displayed in the header at approximately 40x40px.",
        "If the image fails to load, the UI still shows a readable fallback (e.g., text \"Q2\")."
      ]
    }
  ],
  "constraints": [
    "Frontend immutable paths must not be edited: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui.",
    "Backend must remain a single Motoko actor if any backend changes are introduced (none required for this request).",
    "Do not introduce third-party authentication providers; Internet Identity only (not needed for this request)."
  ],
  "nonGoals": [
    "Implementing real ad network integration (the ad area remains a placeholder).",
    "Adding multiplayer, real-time features, chat, or WebSockets.",
    "Adding backend persistence/leaderboards/high scores unless explicitly requested later.",
    "Changing the OpenTDB data source to another trivia provider."
  ],
  "imageRequirements": {
    "required": [
      "Flat app logo icon with bold \"Q2\" lettering on an emerald green rounded-square background (q2-answers-logo.dim_256x256.png)"
    ],
    "edits": []
  }
}